try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c87ef51e-ce63-4ed1-82d5-f179512ed2c6",e._sentryDebugIdIdentifier="sentry-dbid-c87ef51e-ce63-4ed1-82d5-f179512ed2c6")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1479],{8862:(e,t,a)=>{Promise.resolve().then(a.bind(a,22671))},17473:(e,t,a)=>{"use strict";a.d(t,{v:()=>n});var s=a(99315);let n=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,s.createClient)(),{data:{session:n}}=await a.auth.getSession(),o=new Headers(t.headers);return(null==n?void 0:n.access_token)&&(o.set("Authorization","Bearer ".concat(n.access_token)),o.set("X-User-ID",n.user.id)),fetch(e,{...t,headers:o})}},22671:(e,t,a)=>{"use strict";a.d(t,{default:()=>f});var s=a(58545),n=a(33338),o=a(81749),i=a(44541),r=a(61250),l=a(77363),d=a(17473),u=a(37520),c=a(99315);let w=e=>({US:1,BR:2,RU:2,JP:2,TR:2,DE:1,GB:1,FR:1,IT:1,KR:2,ES:1,AR:2,PL:1,CA:1,UA:2,AU:1,RO:2,NL:1,BE:1,SE:1,CZ:1,GR:2,PT:1,HU:2,AE:2,BY:2,AT:1,CH:1,HK:2,RS:2,BG:2,SG:2,DK:1,SK:2,FI:1,NO:1,NZ:1,IE:1,HR:2,MD:2,BA:2,AL:2,LT:2,SI:1,MK:2,LV:2,EE:2,CY:2,ME:2,MT:2,IS:1,AD:2})[e]||3;var p=a(97287),h=a(87730),v=a(92913);let y=(0,l.default)(()=>Promise.all([a.e(2752),a.e(7583),a.e(7621),a.e(8713),a.e(7474),a.e(3819),a.e(9111),a.e(417)]).then(a.bind(a,70417)),{loadableGenerated:{webpack:()=>[70417]},ssr:!1}),g=e=>(window.authInitializedPromise||(window.authInitializedPromise=new Promise(e=>{window.authInitializedResolve=e})),async(t,a)=>{window.authInitializedPromise&&await window.authInitializedPromise;let s=(0,c.createClient)(),{data:n}=await s.auth.getSession();return n.session?(0,d.v)(t,a):new Response(JSON.stringify({error:"Unauthorized",countryMatch:e.countryMatch,tier:e.tier,country:e.country}),{status:401,headers:{"Content-Type":"application/json"}})}),m=e=>{let t=new FormData;return Object.entries(e).forEach(e=>{let[a,s]=e;if(null!=s){if("string"==typeof s){if(s.startsWith("data:")&&s.includes(";base64,")){let[e,n]=s.split(";base64,"),o=e.replace("data:",""),i=atob(n),r=[];for(let e=0;e<i.length;e++)r.push(i.charCodeAt(e));let l=new Blob([new Uint8Array(r)],{type:o});t.append(a,l)}else t.append(a,s)}else s instanceof Blob||s instanceof File?t.append(a,s):Array.isArray(s)?s.forEach((e,s)=>{t.append("".concat(a,"[").concat(s,"]"),String(e))}):"object"==typeof s?t.append(a,JSON.stringify(s)):"boolean"==typeof s?t.append(a,s?"true":"false"):t.append(a,String(s))}}),t},f=e=>{let[t,a]=(0,o.useState)(e),{userCountry:l,trial_payload:d,trial:f,display_conditions:b,extension_id:I,countries_tier:A,extra_countries:S,visibility:x,paywall_id:E,payments_production:C}=t,k=l?w(l):null,N=null==A?void 0:A.split(" "),M=null==S?void 0:S.split(" "),q=(null==N?void 0:N.includes("1"))&&(null==N?void 0:N.includes("2"))&&(null==N?void 0:N.includes("3"))||(null==N?void 0:N.includes(null==k?void 0:k.toString())),T=null==M?void 0:M.includes(l),R=q||T||!1,j=void 0!==window.navigator&&window.navigator.userAgent.includes("Macintosh"),z=(R||e.device_target&&j&&"RU"!==l)&&x,_=g({countryMatch:q||T,tier:k,country:l}),[P,D]=(0,o.useState)({auth:{},openState:"closed",route:"paywall"}),[L,U]=(0,o.useState)({injectStyles:"",iframeStyles:{}}),[O,B]=(0,o.useState)(!1);(0,o.useEffect)(()=>{window.paywallDebug=!0,window.paywallExtensionId=I},[]),(0,o.useEffect)(()=>{"immediately"===b&&(z?D(e=>({...e,openState:"open"})):i.A.detectInvisible({country:l,countryIsOk:R}));let e=async e=>{var t,s,o,r,w,p;if((0,n.zN)("Window message listener",E,e.data),(null===(t=e.data)||void 0===t?void 0:t.action)==="open")z?(D(e=>({...e,openState:"open"})),U({injectStyles:null===(o=e.data)||void 0===o?void 0:o.injectStyles,iframeStyles:null===(r=e.data)||void 0===r?void 0:r.iframeStyles})):i.A.detectInvisible({country:l,countryIsOk:R});else if((null===(s=e.data)||void 0===s?void 0:s.action)==="renew")D(e=>({...e,openState:"open-with-renew"}));else if("SET_PAYWALL_PROPS"===e.data.type)a(e.data.props),D(e=>({...e,openState:"open-with-renew"}));else if("MAKE_STREAM_REQUEST"===e.data.type){let t=new AbortController;window.paywallAbortControllers=window.paywallAbortControllers||{},window.paywallAbortControllers[e.data.requestId]=t;try{let a={...e.data.options||{},signal:t.signal};if(e.data.useFormData&&a.body){let e="string"==typeof a.body?JSON.parse(a.body):a.body;a.body=m(e),null===(w=a.headers)||void 0===w||delete w["Content-Type"]}let s=await _(e.data.url,a),n=s.headers.get("content-type");if(n&&n.includes("application/json")){let t=await s.json();window.parent.postMessage({requestId:e.data.requestId,data:t,done:!0},"*"),delete window.paywallAbortControllers[e.data.requestId]}else{let a=s.body.getReader(),n=new TextDecoder("utf-8"),o=!1;for(;!o;){let{value:s,done:i}=await a.read();if(o=i,s){let t=n.decode(s,{stream:!i});window.parent.postMessage({requestId:e.data.requestId,chunk:t,done:o},"*")}t.signal.aborted&&(o=!0,await a.cancel(),delete window.paywallAbortControllers[e.data.requestId])}if(!t.signal.aborted){let t=n.decode();t?window.parent.postMessage({requestId:e.data.requestId,chunk:t,done:!0},"*"):window.parent.postMessage({requestId:e.data.requestId,done:!0},"*"),delete window.paywallAbortControllers[e.data.requestId]}}}catch(t){"AbortError"===t.name?window.parent.postMessage({requestId:e.data.requestId,error:"Request aborted",done:!0},"*"):window.parent.postMessage({requestId:e.data.requestId,error:t.message,done:!0},"*")}}else if("MAKE_REQUEST"===e.data.type){let t=new AbortController;window.paywallAbortControllers=window.paywallAbortControllers||{},window.paywallAbortControllers[e.data.requestId]=t;try{let a;let s={...e.data.options||{},signal:t.signal};if(e.data.useFormData&&s.body){let e="string"==typeof s.body?JSON.parse(s.body):s.body;s.body=m(e),null===(p=s.headers)||void 0===p||delete p["Content-Type"]}let n=(0,c.createClient)(),{data:{session:o}}=await n.auth.getSession(),r=e.data.url.includes("api/signout");if(r&&o.user.is_anonymous)document.cookie="sb-mamlskufxvejkdmvpjuh-auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie="sb-mnhoppwajrqbfhwtyivz-auth-token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",u.w.removeItem("access_token"),u.w.removeItem("refresh_token"),a={message:"Successfully signed out"};else{let t=await _(e.data.url,s);a=await t.json(),r&&await n.auth.signOut()}e.data.url.includes("api/v1/paywall/user")&&"Unauthorized"===a.error&&i.A.detectCustom({userError:a}),e.data.url.match(/\/paywall\/[^/]+\/user/)&&(a.subscriptions=a.purchases,a.payments=a.purchases),window.parent.postMessage({requestId:e.data.requestId,response:a},"*"),delete window.paywallAbortControllers[e.data.requestId]}catch(t){"AbortError"===t.name?window.parent.postMessage({requestId:e.data.requestId,error:"Request aborted"},"*"):window.parent.postMessage({requestId:e.data.requestId,error:t.message},"*")}}else if("ABORT_REQUEST"===e.data.type){let t=window.paywallAbortControllers[e.data.requestId];t&&(t.abort(),delete window.paywallAbortControllers[e.data.requestId])}else if("SET_USER_METADATA"===e.data.type)(0,n.zN)("Modal - Setting user metadata",E,e.data.metadata),JSON.stringify(e.data.metadata).length>100?((0,n.zN)("Metadata size exceeds 100 symbols",E),window.parent.postMessage({requestId:e.data.requestId,error:"Metadata size exceeds 100 symbols"},"*")):D(t=>({...t,userMetadata:e.data.metadata}));else if("GET_TRIAL_INFO"===e.data.type){if("time"===f){let t;let a="paywall-".concat(E,"-trial-time-first-open");if(void 0!==window.chrome&&void 0!==window.chrome.runtime&&window.paywallExtensionId)try{t=await u.w.getItem(a)}catch(e){console.error("Error reading from Chrome Extension Storage:",e),t=localStorage.getItem(a)}else t=localStorage.getItem(a);let s=t?new Date(Number(t)):null,n=s?new Date(s.getTime()+36e5*Number(d)):null;window.parent.postMessage({requestId:e.data.requestId,response:{expirationStart:(null==s?void 0:s.getTime())||0,expirationEnd:(null==n?void 0:n.getTime())||0,expirationTime:36e5*Number(d),expired:!!t&&new Date().getTime()>(null==n?void 0:n.getTime())}},"*")}else if("opens"===f){let t;let a="paywall-".concat(E,"-skip-times");if(void 0!==window.chrome&&void 0!==window.chrome.runtime&&window.paywallExtensionId)try{t=await u.w.getItem(a)}catch(e){console.error("Error reading from Chrome Extension Storage:",e),t=localStorage.getItem(a)}else t=localStorage.getItem(a);window.parent.postMessage({requestId:e.data.requestId,response:{remainingActions:Number(d)-Number(t||0),totalActions:Number(d),expired:Number(t||0)>=Number(d)}},"*")}else window.parent.postMessage({requestId:e.data.requestId,response:"no trial"},"*")}};return i.A.paywallId=E,window.addEventListener("message",e),window.parent.postMessage({state:"ready"},"*"),z?i.A.init():(i.A.detectInvisible({country:l,countryIsOk:R}),D(e=>({...e,openState:"closed",lastAction:null}))),()=>{window.removeEventListener("message",e)}},[]),(0,o.useEffect)(()=>{if(P.auth.userId){let e="google-sign-in-click"===P.lastAction,t="restore-account-click"===P.lastAction,a="anonymous-sign-in-click"===P.lastAction;t||e?(0,h.w)(E,C,P.auth.userId).then(a=>{D(s=>({...s,route:t?a?"success-restore":"paywall":e?"success-login":s.route,lastAction:null})),t&&!a&&(0,v.l)("Your account was restored, but no active purchase found.",1/0,!0)}):a?(i.A.detectCustom({visibility_status:"invisible"}),(0,i.R)(),D(e=>({...e,openState:"closed",lastAction:null}))):D(t=>({...t,route:e?"success-login":t.route,lastAction:e||"restore-account-click"===t.lastAction?null:t.lastAction}))}},[P.auth.userId]);let G=async()=>{var e;let t=(0,c.createClient)(),a=await t.auth.getSession();(null===(e=a.data)||void 0===e?void 0:e.session)&&(D(e=>{var t,s,o,r,l,d;let u="google-sign-in-click"===e.lastAction;return i.A.detectSignIn(a.data.session.user,u),(0,n.zN)("Change auth event",E,null===(s=a.data)||void 0===s?void 0:null===(t=s.session)||void 0===t?void 0:t.user),p.gV({email:null===(o=a.data.session.user)||void 0===o?void 0:o.email,id:null===(r=a.data.session.user)||void 0===r?void 0:r.id}),{...e,auth:{userId:null===(l=a.data.session.user)||void 0===l?void 0:l.id,userEmail:null===(d=a.data.session.user)||void 0===d?void 0:d.email}}}),window.authInitializedResolve&&window.authInitializedResolve()),B(!0)},J=()=>{D(e=>({...e,lastAction:null,auth:{userId:void 0,userEmail:void 0}})),i.A.detectSignOut(),window.authInitializedPromise=new Promise(e=>{window.authInitializedResolve=e}),window.authInitializedResolve()};return(0,o.useEffect)(()=>{let e;return(()=>{(0,n.zN)("Auth cookie store init watcher",E);try{e=cookieStore.addEventListener("change",e=>{e.changed.some(e=>{let{name:t}=e;return t.includes("auth-token")&&!t.includes("code-verifier")})?((0,n.zN)("Auth cookie store - change event fired",E,e.changed),G()):e.deleted.some(e=>{let{name:t}=e;return t.includes("auth-token")&&!t.includes("code-verifier")})&&((0,n.zN)("Auth cookie store - destroy",E,e.deleted),J())})}catch(e){(0,n.zN)("Auth cookie store watcher error",E,e)}})(),()=>{try{e&&"undefined"!=typeof cookieStore&&(cookieStore.removeEventListener(e),(0,n.zN)("Auth cookie store listener removed",E))}catch(e){(0,n.zN)("Error removing cookie store listener",E,e)}}},[]),(0,o.useEffect)(()=>{G();let e=e=>{(0,n.zN)("Chrome Extension Message - change event fired",E,e),"set"===e.type?G():"remove"!==e.type||e.key.includes("code-verifier")||J()};return u.w.onChanged(e),window.authInitializedResolve&&window.authInitializedResolve(),()=>{u.w.offChanged(e)}},[]),("open"===P.openState||"open-with-renew"===P.openState)&&O?(0,s.jsxs)(r.A.Provider,{value:{appState:P,setAppState:D},"data-sentry-element":"AppContext.Provider","data-sentry-component":"PaywallClient","data-sentry-source-file":"PaywallClient.tsx",children:[L.injectStyles&&(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:L.injectStyles}}),(0,s.jsx)(y,{...t,userCountryTier:k,iframeStyles:L.iframeStyles,"data-sentry-element":"PaywallModal","data-sentry-source-file":"PaywallClient.tsx"})]}):null}},70874:(e,t,a)=>{"use strict";a.d(t,{x:()=>n});var s=a(83792);let n=(0,s.createServerReference)("7ffe0ca3e8bea9bd0db368d1cd8b55cded03e969b8",s.callServer,void 0,s.findSourceMapURL,"getUserPurchasesRequest")},87730:(e,t,a)=>{"use strict";a.d(t,{w:()=>r});var s=a(44541),n=a(70874),o=a(99315),i=a(33338);let r=async(e,t,a)=>{if((0,i.zN)("Checking active purchase",e,{userId:a,payments_production:t}),!a)return!1;{var r;let i=await (0,n.x)({paywallId:Number(e),userId:a,payments_production:t}),l=null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.find(e=>"active"===e.status||"paid"===e.status||"trialing"===e.status);return!!l&&((0,o.createClient)().auth.getSession().then(e=>{var t,a,n,o;(null===(a=e.data)||void 0===a?void 0:null===(t=a.session)||void 0===t?void 0:t.user)&&s.A.detectSignIn(null===(o=e.data)||void 0===o?void 0:null===(n=o.session)||void 0===n?void 0:n.user)}),s.A.detectActivePurchase({purchase:l,status:"restored"}),!0)}}},92913:(e,t,a)=>{"use strict";a.d(t,{l:()=>o});var s=a(58545),n=a(66032);a(81749);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2?arguments[2]:void 0;return n.Ay.custom(t=>(0,s.jsxs)("div",{className:"".concat(t.visible?"animate-enter":"animate-leave"," w-full max-w-[400px] bg-white shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5"),children:[(0,s.jsxs)("div",{className:"flex gap-3 flex-1 w-0 p-4 pr-2",children:[a?(0,s.jsx)("svg",{className:"w-5 h-5 text-warning","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM10 15a1 1 0 1 1 0-2 1 1 0 0 1 0 2Zm1-4a1 1 0 0 1-2 0V6a1 1 0 0 1 2 0v5Z"})}):(0,s.jsx)("svg",{viewBox:"0 0 24 24",className:"text-success-600 w-5 h-5",children:(0,s.jsx)("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})}),(0,s.jsx)("div",{className:"flex flex-1 items-start text-sm text-default-600",children:e})]}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsxs)("button",{onClick:()=>{n.Ay.dismiss(t.id)},className:"ms-auto text-gray-400 rounded-lg p-1.5 inline-flex items-center justify-center h-8 w-8",children:[(0,s.jsx)("span",{className:"sr-only",children:"Close"}),(0,s.jsx)("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:(0,s.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})})]})})]}),{duration:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6547,1211,3157,6188,4918,7358],()=>t(8862)),_N_E=e.O()}]);