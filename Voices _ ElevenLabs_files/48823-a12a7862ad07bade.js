try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="9217b8d6-266b-4beb-b1b4-a9c06695d5da",e._sentryDebugIdIdentifier="sentry-dbid-9217b8d6-266b-4beb-b1b4-a9c06695d5da")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48823],{88146:function(e,r,n){n.d(r,{T:function(){return x},t:function(){return p}});var i=n(68088),s=n(34690),t=n(23474),a=n(79459),l=n(38028),o=n(4735),c=n(70140),d=n(21113),u=n(79458),h=n(26397);(0,d.Z)("file:///app/src/components/Pagination.tsx").assert(!0);let m=(e,r)=>r-e<=0?[]:[...Array(r-e).keys()].map(r=>r+e),x=e=>{let{page:r,itemCount:n,onChange:a,itemsPerPage:l}=e,o=0!==r,c=(r+1)*l<n,d=Math.ceil(n/l),x=[];return x=d<8||r-3<0?m(0,Math.min(d,8)):r+4>d?m(Math.max(0,d-8),d):[...m(r-3,r),r,...m(r+1,r+4+1)],(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-1 justify-between sm:hidden items-center",children:[(0,i.jsx)(u.default,{disabled:!o,onClick:o?()=>{a(r-1)}:void 0,variant:"white",size:"sm",children:"Previous"}),(0,i.jsxs)(h.default,{className:"text-sm text-gray-700",noBaseClass:!0,variant:"span",children:["Page ",r+1," of ",d]}),(0,i.jsx)(u.default,{disabled:!c,onClick:c?()=>{a(r+1)}:void 0,variant:"white",size:"sm",children:"Next"})]}),(0,i.jsxs)("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[(0,i.jsx)("div",{children:(0,i.jsxs)(h.default,{className:"text-sm text-gray-700",noBaseClass:!0,variant:"p",children:["Showing"," ",(0,i.jsx)("span",{className:"font-medium",children:r*l+1})," to"," ",(0,i.jsx)("span",{className:"font-medium",children:Math.min((r+1)*l,n)})," ","of ",(0,i.jsx)("span",{className:"font-medium",children:n})," results"]})}),(0,i.jsx)("div",{children:(0,i.jsxs)("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[(0,i.jsxs)("a",{className:"".concat(o?"cursor-pointer hover:bg-gray-50":""," relative inline-flex items-center rounded-l-md border border-gray-300 bg-background px-2 py-2 text-sm font-medium text-gray-500 focus:z-20"),onClick:o?()=>{a(r-1)}:void 0,children:[(0,i.jsx)(h.default,{className:"sr-only",noBaseClass:!0,children:"Previous"}),(0,i.jsx)(s.Z,{className:"h-5 w-5","aria-hidden":"true"})]}),x.map(e=>(0,i.jsx)("a",{onClick:()=>{a(e)},"aria-current":e===r?"page":void 0,className:"relative inline-flex items-center border ".concat(e===r?"border-slate-800 bg-slate-200 text-foreground z-10":"border-gray-300 bg-background cursor-pointer"," px-4 py-2 text-sm font-medium focus:z-20"),children:e+1},e)),(0,i.jsxs)("a",{className:"".concat(c?"cursor-pointer hover:bg-gray-50":""," relative inline-flex items-center rounded-r-md border border-gray-300 bg-background px-2 py-2 text-sm font-medium text-gray-500 focus:z-20"),onClick:c?()=>{a(r+1)}:void 0,children:[(0,i.jsx)(h.default,{className:"sr-only",noBaseClass:!0,children:"Next"}),(0,i.jsx)(t.Z,{className:"h-5 w-5","aria-hidden":"true"})]})]})})]})]})},p=e=>{let{pageNumber:r,canLoadPreviousPage:n,canLoadNextPage:s,loadPreviousPage:t,loadNextPage:d,className:u}=e;return(0,i.jsxs)("div",{className:(0,c.A)("h-[58px] flex justify-between items-center pl-6 pr-4 py-2 gap-4",u),children:[(0,i.jsxs)("span",{className:(0,c.A)("inter text-[#6B7280] text-[12px] font-bold"),style:{letterSpacing:.6},children:["PAGE ",r]}),(0,i.jsxs)("div",{className:"flex gap-1.5",children:[(0,i.jsxs)(o.Button,{disabled:!n,onClick:t,size:"sm",variant:"outline",className:"gap-1",children:[(0,i.jsx)(a.Z,{}),"Previous"]}),(0,i.jsxs)(o.Button,{disabled:!s,onClick:d,size:"sm",variant:"outline",className:"gap-1",children:["Next",(0,i.jsx)(l.Z,{})]})]})]})}},5024:function(e,r,n){n.d(r,{R:function(){return ep}});var i=n(68088),s=n(18743),t=n(81999),a=n(93281),l=n(9506),o=n(1851),c=n(89219),d=n(60189),u=n(39255),h=n(26542),m=n(4111),x=n(55673),p=n(3540),f=n(6970),v=n.n(f),g=n(73998),y=n(72794),j=n(42454),b=n(24469),w=n(82374),_=n(70108),N=n(30487),k=n(72228),S=n(4735),C=n(73940),I=n(44463),L=n(46547),P=n(50113),E=n(64755),A=n(11521),D=n(84106),T=n(25933),z=n(90675),F=n(21113),O=n(47230),Z=n(50267),B=n(5558);let V=(0,F.Z)("file:///app/src/components/Pronunciations/PronunciationDictionaries.tsx"),R=(0,t.Pi)(()=>{var e;let{query:r,observable:n}=(0,h.GV)(),[s,t]=(0,z.w)({search:"",offset:0}),a=(0,w.Nr)(s.search,200),o=(0,l.useMemo)(()=>{var e,n;let i=v()(null!==(n=null===(e=r.data)||void 0===e?void 0:e.pages.flatMap(e=>e.pronunciation_dictionaries.filter(e=>!e.archived_time_unix)))&&void 0!==n?n:[],"id");if(!a)return i;let s=a.toLowerCase();return i.filter(e=>e.name.toLowerCase().includes(s))},[r.data,a]),x=!r.isFetching&&!s.search&&0===o.length,f=!r.isFetching&&!x&&0===o.length,g=(0,l.useRef)(null),y=(0,l.useRef)(null),j=(0,p.MG)({count:o.length,getScrollElement:()=>y.current,estimateSize:()=>40,overscan:10}),{measureElement:b,scrollToIndex:_}=j,N=g.current===document.activeElement;(0,l.useEffect)(()=>{if(!N){if(o[s.offset]){let e=o.length-1,r=y.current;if(r&&0===s.offset?r.scrollTop=r.scrollTop=0:r&&s.offset===e?r.scrollTop=r.scrollHeight:_(s.offset,{align:s.offset<=1?"end":"auto"}),!y.current)return;let n=Array.from(y.current.querySelectorAll("li")).find(e=>e.getAttribute("data-index")==="".concat(s.offset));null==n||n.focus()}else 0!==s.offset&&t({offset:0})}},[N,s.offset]);let S=null===(e=n.selectedLocator)||void 0===e?void 0:e.pronunciation_dictionary_id,I=(0,u.bs)("md");(0,l.useEffect)(()=>{if(S&&o.length)t({offset:Math.max(0,o.findIndex(e=>e.id===S))});else if(o.length&&I){let{id:e,latest_version_id:r}=o[0];n.selectLocator({pronunciation_dictionary_id:e,version_id:r})}},[S,o.length,I]);let P=j.getVirtualItems(),E=()=>{n.setQueryOptions({sort:void 0}),t({offset:0,search:""})};return(0,i.jsxs)("div",{className:"flex flex-col h-full w-full relative",children:[(0,i.jsxs)("div",{className:(0,d.cn)("flex shrink-0 items-center justify-between pl-4 pr-3 pt-3 gap-1",!n.selectedLocator&&"pr-10"),children:[(0,i.jsx)(c.$N,{className:"!text-sm",children:"Pronunciation Dictionaries"}),(0,i.jsx)(U,{isIconButton:!0,onSuccess:E})]}),(0,i.jsx)("div",{className:"w-full flex justify-between items-center gap-2 border-b",children:(0,i.jsx)(L.I,{ref:g,placeholder:"Search dictionaries...",className:"flex-1 px-4 py-4 h-auto outline-none focus-visible:ring-0 rounded-none focus:ring-0 shadow-none ring-0 border-none border-0",value:s.search,onChange:e=>{t({offset:0,search:e.target.value})}})}),(0,i.jsxs)("div",{ref:y,className:(0,d.cn)("overflow-y-auto flex-1 w-full"),children:[r.isFetching&&(0,i.jsx)("div",{className:"overlay center",children:(0,i.jsx)(m.$,{size:"md",color:"black"})}),x?(0,i.jsx)(M,{clearFilters:E}):f?(0,i.jsx)(G,{clearFilters:E}):(0,i.jsx)("div",{style:{height:"".concat(j.getTotalSize(),"px"),transitionProperty:"height",transition:"100ms ease",position:"relative",overflow:"hidden"},children:P.length?(0,i.jsxs)("ul",{style:{position:"absolute",top:0,left:0,width:"100%",transform:"translateY(".concat(P[0].start,"px)")},tabIndex:0,onKeyDown:e=>{if("Tab"===e.key&&o[s.offset+1])e.preventDefault(),t({offset:s.offset+1});else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();let r="ArrowDown"===e.key?s.offset+1:s.offset-1;if(!o[r])return;t({offset:r})}},children:[P.map(e=>{var r;let{key:s,index:t}=e,a=o[t];if(!a)return null;let l=(null===(r=n.selectedLocator)||void 0===r?void 0:r.pronunciation_dictionary_id)===a.id,c=()=>{n.selectLocator({pronunciation_dictionary_id:a.id,version_id:a.latest_version_id})};return(0,i.jsxs)("li",{ref:b,"data-index":t,"aria-labelledby":a.id,tabIndex:0,className:(0,d.cn)("group flex items-center justify-between gap-1 px-4 py-2 focus:outline-none focus-visible:ring-[1.5px] ring-inset ring-gray-alpha-950",l?"bg-gray-alpha-100":"hover:bg-gray-alpha-50"),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),c())},onClick:c,children:[(0,i.jsx)(A.x,{className:"max-w-sm",truncate:!0,children:a.name}),(0,i.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,B.B)(a.id)&&(0,i.jsx)(T.Tooltip,{placement:"top",label:"This dictionary is being applied across the workspace",children:(0,i.jsx)(k.Ct,{variant:"secondary",className:"cursor-default",children:"Workspace"})}),(0,i.jsx)(T.Tooltip,{placement:"top",label:"".concat(a.latest_version_rules_num," rules"),children:(0,i.jsx)(k.Ct,{variant:"default",className:"cursor-default",children:a.latest_version_rules_num})}),(0,i.jsx)(A.x,{color:"subtle",size:"xs",children:(0,C.$)(a.creation_time_unix).shortDate})]})]},s)}),r.hasNextPage&&(0,i.jsx)(O.Z,{loading:r.isFetching,onTrigger:()=>r.fetchNextPage(),loadInAdvanceMargin:200})]}):null})]})]})}),M=e=>{let{clearFilters:r}=e;return(0,i.jsx)("div",{className:"flex w-full md:h-full md:justify-center md:items-center",children:(0,i.jsxs)(I.rJ,{className:"m-4",children:[(0,i.jsx)(I.FL,{children:(0,i.jsx)(g.Z,{})}),(0,i.jsx)(I.ed,{children:"No dictionaries"}),(0,i.jsx)(I.U5,{children:"Lexicon dictionaries apply pronunciation replacements in your projects."}),(0,i.jsx)(I.aT,{children:(0,i.jsx)(U,{variant:"primary",onSuccess:r})})]})})},G=e=>{let{clearFilters:r}=e;return(0,i.jsx)("div",{className:"flex w-full md:h-full md:justify-center md:items-center",children:(0,i.jsxs)(I.rJ,{className:"m-4",children:[(0,i.jsx)(I.FL,{children:(0,i.jsx)(y.Z,{})}),(0,i.jsx)(I.ed,{children:"No results"}),(0,i.jsx)(I.U5,{children:"No pronunciation dictionaries were found with the current filters."}),(0,i.jsx)(I.aT,{children:(0,i.jsx)(S.Button,{className:"bg-background",onClick:r,children:"Clear filters"})})]})})},U=e=>{let{isIconButton:r,onSuccess:n,...s}=e,{query:t,observable:a}=(0,h.GV)(),[l,o]=(0,z.w)({popoverOpen:!1}),c=e=>{t.pronunciationsSet({...e,latest_version_id:e.version_id,latest_version_rules_num:e.version_rules_num,archived_time_unix:null}),o({popoverOpen:!1}),a.selectLocator({pronunciation_dictionary_id:e.id,version_id:e.version_id}),null==n||n(e)},d=(0,N.WZ3)({onSuccess:c,onError:e=>{V.error(e),D.toast.errorHttp(e,"We were unable to create the pronunciation dictionary.")}}),u=(0,x.useMutation)({mutationFn:e=>{let{inputFile:r,name:n}=e;return(0,_.GU)({inputFile:r,name:n,onSuccess:(e,r)=>c(r),onError:e=>{V.error(e),D.toast.error("We were unable to upload the pronunciation dictionary.")}})}}),m=u.isLoading||d.isLoading;return(0,i.jsxs)(E.J2,{open:l.popoverOpen,onOpenChange:e=>o({popoverOpen:e}),children:[(0,i.jsx)(E.xo,{asChild:!0,disabled:m,children:r?(0,i.jsx)(S.Button,{"aria-label":"Add dictionary",disabled:m,variant:"primary",...s,tooltip:"Add dictionary",className:"h-8",leftIcon:(0,i.jsx)(j.Z,{strokeWidth:2.5}),children:"New"}):(0,i.jsx)(S.Button,{disabled:m,...s,children:"Add dictionary"})}),(0,i.jsx)(E.yk,{align:"center",className:"w-full max-w-[360px] shadow-natural-md border-0 p-0",side:"bottom",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)(A.x,{color:"subtle",className:"mb-3 text-xm px-2 pt-4 text-center",children:["Lexicon dictionaries apply pronunciation replacements."," ",(0,i.jsx)(P.Un,{href:"https://elevenlabs.io/docs/best-practices/prompting/controls#pronunciation-dictionaries",target:"_blank",children:"IPA phonemes"})," ","only work with English models, while aliases are compatible with all models."]}),(0,i.jsx)("div",{className:"w-full h-full text-foreground border-subtle border-b",children:(0,i.jsx)(Z.Z,{accept:".txt,.pls,.xml,audio/x-scpls,text/plain,text/xml",onChange:e=>{let r=e[0];if(r.size>1e6*J){D.toast.error("File size exceeds the ".concat(J,"MB limit"));return}u.mutate({inputFile:r,name:r.name})},className:"w-full h-full flex items-center justify-center border-none !pt-3",children:(0,i.jsx)(S.Button,{className:"ps-4 gap-1.5",leftIcon:(0,i.jsx)(b.Z,{}),disabled:m,loading:u.isLoading,children:"Upload lexicon file"})})}),(0,i.jsxs)("div",{className:"flex justify-between items-center p-2",children:[(0,i.jsx)(S.Button,{"aria-label":"Create dictionary",disabled:m,size:"sm",loading:d.isLoading,onClick:()=>{d.mutate({body:{name:"Dictionary",rules:[]}})},children:"Create from scratch"}),(0,i.jsxs)(A.x,{color:"subtle",className:"ms-auto",size:"xs",children:[[".pls",".txt",".xml"].map(e=>(0,i.jsx)("code",{className:"bg-background border border-gray-200 rounded-md p-0.5 mr-1",children:e},e)),"Max ",J,"MB"]})]})]})})]})},J=1.5;var $=n(97918),H=n(97087),Q=n(20147),W=n(95972),q=n(79306),K=n(69881),Y=n(3030),X=n(16843),ee=n(96162),er=n(14076),en=n(70554),ei=n(68459),es=n(88462),et=n(8020),ea=n(49596);let el=e=>{let{dictionary:r,children:n,...s}=e;return(0,i.jsxs)(c.Vq,{...s,children:[n,(0,i.jsx)(c.cZ,{children:(0,i.jsxs)(c.fK,{children:[(0,i.jsx)(c.$N,{children:"Share Dictionary"}),(0,i.jsx)(ea.ZP,{resourceId:r.id,resourceName:r.name,resourceType:"pronunciation_dictionary",resourceTypeDisplayName:"Pronunciation Dictionary"})]})})]})};var eo=n(90610),ec=n(60350);let ed=(0,F.Z)("file:///app/src/components/Pronunciations/PronunciationEditor.tsx"),eu=(0,t.Pi)(e=>{var r,n,s,t;let{locator:a}=e,l=(0,er.z)(),o=(0,N.om$)(),c=(0,N.FJ$)(),{query:d,observable:u}=(0,h.GV)(),[x,p]=(0,z.w)({loading:!1}),f=(0,eo.X1)(),v=null!==(t=(0,eo.y)(null===(r=u.context)||void 0===r?void 0:r.voiceId))&&void 0!==t?t:f[0],{data:g,isLoading:y,error:j,isPreviousData:b}=(0,$.useQuery)({queryKey:(0,ec.L)(a),queryFn:()=>(0,N.HMR)({pathParams:{pronunciationDictionaryId:a.pronunciation_dictionary_id,versionId:a.version_id||"latest"}}),onError:e=>{ed.error("Failed to fetch pronunciation dictionary",e),D.toast.error("Failed to fetch pronunciation dictionary")},cacheTime:0,keepPreviousData:!0});return j?(0,i.jsx)(em,{}):y?null:g?(0,i.jsx)(X.C1,{initialValue:g,metadata:{role:g.permission_on_resource||"viewer"},onValueCommit:async e=>{let r=e.toJSON(),{rules:n}=e;try{p({loading:!0});let s=null;if(e.changes.some(e=>"name"===e.keyword)){let{id:e,latest_version_id:n}=await o.mutateAsync({pathParams:{pronunciationDictionaryId:r.pronunciation_dictionary_id},body:{name:r.dictionary_name}});s={id:e,version_id:n}}if((e.changes.some(e=>"size"===e.keyword)||n.some(e=>e.changes.length))&&(s=await c.mutateAsync({pathParams:{pronunciationDictionaryId:r.pronunciation_dictionary_id},body:{rules:r.rules}})),s){var i;d.pronunciationsSet({...r,id:s.id,latest_version_id:s.version_id,latest_version_rules_num:r.rules.length,name:r.dictionary_name,archived_time_unix:null!==(i=r.archived_time_unix)&&void 0!==i?i:null}),e.commit({versionId:s.version_id})}}finally{p({loading:!1})}},onRulePlay:async(e,r)=>{if(!v)return D.toast.error("Please select a voice");for(let r of e.rules)"paused"!==r.state.audioStatus&&r.setState({audioStatus:"paused"});try{let n=r.toJSON();r.setState({audioStatus:"loading"});let i="".concat(ee.LB,"/v1/pronunciation-dictionaries/").concat(e.data.pronunciation_dictionary_id,"/text-to-speech"),s=await (0,ei.w)(i,"POST",{body:JSON.stringify({rule:n,voice_id:v.voice_id})});await (0,en.D6)({response:s,audioEl:l.player.audio,onContentStart:()=>{if(!l.player.audio||"loading"!==r.state.audioStatus)return;let e=l.player.addListener(n=>{n.isPlaying?r.setState({audioStatus:"playing"}):(r.setState({audioStatus:"paused"}),e())});l.player.play()}})}catch(e){ed.error(e),D.toast.error("Failed to preview pronunciation rule. Please try again."),r.setState({audioStatus:"paused"})}},onRulePause:(e,r)=>{l.player.kill(),r.setState({audioStatus:"paused"})},children:(0,i.jsxs)("div",{className:"relative flex flex-col justify-between h-full w-full",children:[b&&(0,i.jsx)("div",{className:"overlay center bg-background/50 z-10",children:(0,i.jsx)(m.$,{size:"md",color:"black"})}),(0,i.jsxs)("div",{className:"flex flex-col w-full border-b",children:[(0,i.jsxs)("div",{className:"flex w-full items-center justify-between gap-1 pr-10",children:[(0,i.jsx)(Y.h,{variant:"ghost","aria-label":"Go back",className:"md:hidden mt-2 ml-2",size:"sm",onClick:()=>u.selectLocator(null),children:(0,i.jsx)(H.Z,{})}),(0,i.jsx)(X.Nf,{className:"w-full"}),g.archived_time_unix?(0,i.jsx)(T.Tooltip,{label:"Archived ".concat((0,C.$)(g.archived_time_unix).shortDate),children:(0,i.jsx)(es.Z,{color:"red",size:"sm",children:"Archived"})}):null]}),(0,i.jsx)(X.$Z,{children:(0,i.jsx)(et.Q,{buttonClassName:"overflow-hidden w-fit",value:v,placeholder:"Preview voice",onValueChange:e=>{let{voice_id:r}=e;u.setContext({voiceId:r})},side:"bottom",align:"center",formStylingSize:"sm",autoFocus:!1})})]}),(0,i.jsx)(X.qd,{}),(0,i.jsxs)("div",{className:"flex flex-shrink-0 items-center justify-between px-3 py-3 border-t",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(eh,{dictionary:{...g,id:g.pronunciation_dictionary_id,name:g.dictionary_name,latest_version_id:g.version_id,latest_version_rules_num:g.rules.length,archived_time_unix:g.archived_time_unix||null}}),null===(n=(s=u.context).renderAction)||void 0===n?void 0:n.call(s,g)]}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(X.gX,{disabled:b,loading:x.loading})})]})]})},g.pronunciation_dictionary_id):(0,i.jsx)(ex,{})}),eh=(0,t.Pi)(e=>{var r;let{dictionary:n,className:s,...t}=e,[a,c]=(0,z.w)({shareDialogOpen:!1}),u=(0,N.om$)(),m=(0,N.ehc)({onError:e=>{D.toast.errorHttp(e,"Unexpected error updating workspace")}}),{query:x}=(0,h.GV)(),p=(null===(r=o.workspaceData.value)||void 0===r?void 0:r.storing_shared_files_on_user)===!1&&"admin"===n.permission_on_resource,f=(0,W.dl)("workspace-pronunciation-dictionaries");return(0,i.jsxs)(l.Fragment,{children:[(0,i.jsx)(el,{open:a.shareDialogOpen,onOpenChange:e=>c({shareDialogOpen:e}),dictionary:{id:n.id,name:n.name}}),(0,i.jsxs)(E.J2,{children:[(0,i.jsx)(E.xo,{asChild:!0,children:(0,i.jsx)(Y.h,{variant:"ghost",size:"md","aria-label":"Open pronunciation dictionary dropdown",className:(0,d.cn)("flex-shrink-0",s),...t,children:(0,i.jsx)(Q.Z,{})})}),(0,i.jsx)(E.i9,{children:(0,i.jsx)(E.yk,{className:"p-1 w-[280px]",asChild:!0,children:(0,i.jsx)(K.mY,{children:(0,i.jsxs)(q.Z,{children:[(0,i.jsx)(K.di,{tabIndex:1,disabled:u.isLoading,onSelect:async()=>{await (0,_.S9)({id:n.id,versionId:n.latest_version_id,name:n.name})},children:"Download dictionary"}),p&&(0,i.jsx)(K.di,{tabIndex:1,onSelect:()=>c({shareDialogOpen:!0}),children:"Share dictionary"}),n.archived_time_unix?(0,i.jsx)(K.di,{tabIndex:1,onSelect:async()=>{await u.mutateAsync({pathParams:{pronunciationDictionaryId:n.id},body:{archived:!1}}),x.pronunciationsSet({...n,archived_time_unix:null})},children:"Restore dictionary"}):(0,i.jsx)(K.di,{tabIndex:1,disabled:u.isLoading,onSelect:async()=>{await u.mutateAsync({pathParams:{pronunciationDictionaryId:n.id},body:{archived:!0}}),x.pronunciationsSet({...n,archived_time_unix:Date.now()})},children:"Archive dictionary"}),o.isWorkspaceAdmin.value&&f?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(K.zz,{}),(0,B.B)(n.id)?(0,i.jsx)(K.di,{tabIndex:1,disabled:m.isLoading,onSelect:async()=>{m.mutate({body:{pronunciation_dictionary_locators:[]}})},className:"flex items-center justify-between",children:"Remove as workspace dictionary"}):(0,i.jsx)(K.di,{tabIndex:1,disabled:m.isLoading,onSelect:async()=>{m.mutate({body:{pronunciation_dictionary_locators:[{pronunciation_dictionary_id:n.id,version_id:null}]}})},className:"flex items-center justify-between",children:"Apply dictionary across workspace"})]}):null]})})})})]})]})}),em=()=>{let{observable:e}=(0,h.GV)();return(0,i.jsxs)(I.rJ,{className:"m-8",children:[(0,i.jsx)(I.FL,{children:(0,i.jsx)(y.Z,{})}),(0,i.jsx)(I.ed,{children:"Error"}),(0,i.jsx)(I.U5,{children:"There was an unexpected error loading this dictionary."}),(0,i.jsx)(I.aT,{children:(0,i.jsx)(S.Button,{variant:"primary",onClick:()=>e.selectLocator(null),children:"Back to dictionaries"})})]})},ex=()=>{let{observable:e}=(0,h.GV)();return(0,i.jsxs)(I.rJ,{className:"m-8",children:[(0,i.jsx)(I.FL,{children:(0,i.jsx)(g.Z,{})}),(0,i.jsx)(I.ed,{children:"Dictionary not found"}),(0,i.jsx)(I.U5,{children:"This dictionary could not be found."}),(0,i.jsx)(I.aT,{children:(0,i.jsx)(S.Button,{variant:"primary",onClick:()=>e.selectLocator(null),children:"Back to dictionaries"})})]})},ep=(0,t.Pi)(()=>{let[e,r]=(0,a.v1)("pronunciation-dictionaries",a.AE.withDefault(!1).withOptions({history:"push"})),n=(0,h.oe)();(0,l.useEffect)(()=>{"pronunciationDictionaries"===o.dialogOpen.value&&(r(!0),n.observable.setOpen(!0))},[o.dialogOpen.value]),(0,l.useEffect)(()=>{n.observable.open||(o.dialogOpen.value=!1,r(!1),n.observable.reset())},[n.observable.open]),(0,l.useEffect)(()=>{e&&n.observable.setOpen(!0)},[e]);let t=(0,u.bs)("md"),{selectedLocator:m}=n.observable,x=ef[n.observable.route.path];return(0,i.jsxs)(h.k1.Provider,{value:n,children:[n.observable.open&&(0,i.jsx)("div",{className:c.T5}),(0,i.jsx)(c.Vq,{open:n.observable.open,onOpenChange:e=>{e||n.observable.setOpen(!1)},modal:!1,children:(0,i.jsx)(c.cZ,{"aria-describedby":"Pronunciation dictionaries editor",className:(0,d.cn)("p-0 !rounded-none gap-0 flex flex-col overflow-hidden shadow-natural-md border-0",t?"!rounded-[20px] w-[calc(100%_-_36px)] h-[calc(100%_-_36px)] !max-w-[1024px] max-h-[900px]":"h-full w-full max-h-none !max-w-none"),closeButtonClassname:"right-[18px] top-[18px]",children:(0,i.jsxs)("div",{className:"flex w-full h-full box-border",children:[(0,i.jsx)("div",{className:(0,d.cn)("flex flex-col h-full border-r overflow-hidden transition-all duration-150",m&&t||t||!m?"w-full":"w-0"),children:x?(0,i.jsx)(x,{}):null}),(0,i.jsx)(s.M,{children:(0,i.jsx)("div",{className:(0,d.cn)("h-full bg-gray-alpha-50 transition-all duration-150",t&&m?"w-[180%]":m?"w-full":"w-0"),children:m&&(0,i.jsx)(eu,{locator:m})})})]})})})]})}),ef={dictionaries:R}},30469:function(e,r,n){n.d(r,{B:function(){return j},OnlyForAdmin:function(){return f},OnlyForLoggedIn:function(){return g},OnlyForLoggedOut:function(){return v},Z:function(){return y}});var i=n(68088),s=n(81999),t=n(23431),a=n(9506),l=n(71443),o=n(1851),c=n(60358),d=n(99348),u=n(96162),h=n(53832),m=n(78190),x=n(58815),p=n(732);let f=(0,s.Pi)(e=>{let{redirectOthersTo:r,children:n}=e,i=(0,t.useRouter)();return((0,a.useEffect)(()=>{"local"!==(0,d.d)().envType&&u.EA.value&&!(0,u.X0)()&&i.push(r)},[u.EA.value]),"local"===(0,d.d)().envType||(0,u.X0)())?n:null}),v=(0,s.Pi)(e=>{let{redirectOthersTo:r,forceRenderChildren:n=!1,children:i}=e,s=(0,m.B8)(r),l=(0,t.useRouter)(),c=(0,a.useRef)(null);return((0,a.useEffect)(()=>{var e;null===c.current&&(!0===o.isLoggedIn.value&&(null===(e=u.EA.value)||void 0===e?void 0:e.emailVerified)&&l.push(s),c.current=o.isLoggedIn.value)},[o.isLoggedIn.value]),(0,a.useEffect)(()=>{let e=e=>{e.origin===window.location.origin&&e.data===x.c&&window.location.reload()};return null===h.Sv||void 0===h.Sv||h.Sv.addEventListener("message",e),()=>{null===h.Sv||void 0===h.Sv||h.Sv.removeEventListener("message",e)}},[s,l]),n&&(!1===o.isLoggedIn.value||!1===c.current))?i:null}),g=(0,s.Pi)(e=>{let{redirectOthersTo:r,children:n}=e,i=(0,t.useRouter)(),s=(0,a.useRef)(null);(0,p.k)();let l=()=>encodeURIComponent("".concat(window.location.pathname).concat(window.location.search));return((0,a.useEffect)(()=>{null===s.current&&(!1===o.isLoggedIn.value&&(r?i.push(r):i.push("".concat(c.ZP.signIn,"?redirect=").concat(l()))),s.current=o.isLoggedIn.value)},[o.isLoggedIn.value]),(0,a.useEffect)(()=>{let e=e=>{e.origin===window.location.origin&&e.data===h.ED&&(window.location.href="".concat(c.ZP.signIn,"?redirect=").concat(l()))};return null===h.Sv||void 0===h.Sv||h.Sv.addEventListener("message",e),()=>{null===h.Sv||void 0===h.Sv||h.Sv.removeEventListener("message",e)}},[]),!0===o.isLoggedIn.value)?n:null}),y=(0,s.Pi)(e=>{let{loggedIn:r,loggedOut:n,children:s}=e;return(0,p.k)(),(0,i.jsx)(i.Fragment,{children:o.isLoggedIn.value?r:s||n})}),j=(0,s.Pi)(e=>{let{redirectOthersTo:r,children:n,message:i}=e,s=(0,t.useRouter)();return((0,a.useEffect)(()=>{!1===o.isWorkspaceAdmin.value&&(l.Am.error(i),s.replace(r))},[o.isWorkspaceAdmin.value]),!0===o.isWorkspaceAdmin.value)?n:null})},49596:function(e,r,n){n.d(r,{VY:function(){return P},e4:function(){return E},pK:function(){return L},tx:function(){return I},wl:function(){return F},xu:function(){return D}});var i=n(68088),s=n(3163),t=n(84909),a=n(53244),l=n(83193),o=n(85378),c=n(9506),d=n(82374),u=n(30487),h=n(1851),m=n(76628),x=n(88146),p=n(26397),f=n(4735),v=n(89219),g=n(3030),y=n(96474),j=n(32689),b=n(91105),w=n(11521),_=n(84106),N=n(96162),k=n(60189),S=n(754);let C="default",I={key:"restricted",name:"Restricted"},L=[{key:"viewer",name:"Viewer"},{key:"editor",name:"Editor"},{key:"admin",name:"Admin"}],P=[I,...L],E={key:"owner",name:"Owner"},A=e=>{let{open:r,closeModal:n,name:s,group:a,resourceId:l,resourceType:o}=e,[d,h]=(0,c.useState)(L[0]),m=(0,t.useQueryClient)(),x=(0,u.T3r)({onError:e=>_.toast.errorHttp(e,"Failed to update sharing settings"),onSuccess(){_.toast.success("Successfully shared resource with ".concat(a.name)),m.invalidateQueries(["v1","workspace","resources",l]),n()}});return(0,c.useEffect)(()=>{r&&h(L[0])},[r]),(0,i.jsx)(v.Vq,{open:r,onOpenChange:n,children:(0,i.jsxs)(v.cZ,{children:[(0,i.jsx)(v.fK,{children:(0,i.jsxs)(v.$N,{children:['Share "',s,'"']})}),(0,i.jsxs)("div",{className:"hstack items-center justify-between",children:[(0,i.jsxs)(y.Label,{size:"md",className:"text-bold",children:["Permission",(0,i.jsxs)(w.x,{size:"sm",children:["Sharing this resource will allow '",a.name,"' to"," ","viewer"===d.key?"view":"edit"," and use it."]})]}),(0,i.jsxs)(b.Select,{value:d.key,onValueChange:e=>{let r=L.find(r=>r.key===e);r&&h(r)},children:[(0,i.jsx)(b.SelectTrigger,{className:"rounded-lg w-[200px]",disabled:x.isLoading,children:(0,i.jsx)(b.SelectValue,{})}),(0,i.jsx)(b.SelectContent,{className:"w-[200px]",children:L.map(e=>(0,i.jsx)(b.SelectItem,{value:e.key,children:e.name},e.key))})]})]}),(0,i.jsxs)(v.cN,{children:[(0,i.jsx)(f.Button,{size:"md",onClick:n,children:"Cancel"}),(0,i.jsx)(f.Button,{loading:x.isLoading,variant:"primary",onClick:()=>{x.mutate({pathParams:{resourceId:l},body:{resource_type:o,group_id:a.id,role:d.key}})},children:"Share"})]})]})})},D=e=>{let{metadata:r,resourceType:n,resourceId:i}=e,[s,a]=(0,c.useState)(I),l=(0,t.useQueryClient)();(0,c.useEffect)(()=>{let e=Object.entries(r.role_to_group_ids||{}).find(e=>{let[r,n]=e;return n.includes(C)});e&&a(P.find(r=>r.key===e[0])||I)},[r]);let o={onError(e){_.toast.errorHttp(e,"Failed to update sharing settings")},onSuccess(){_.toast.success("Sharing settings updated successfully"),l.invalidateQueries(["v1","workspace","resources",i])}},d=(0,u.T3r)(o),h=(0,u.$ir)(o);return{currentPermission:s,handleUpdateGeneralAccess:e=>{a(e);let r={resourceId:i};"restricted"===e.key?h.mutate({pathParams:r,body:{resource_type:n,group_id:C}},{onError:()=>a(s)}):d.mutate({pathParams:r,body:{resource_type:n,group_id:C,role:e.key}},{onError:()=>a(s)})},shareResourceMutation:d,unshareResourceMutation:h}};function T(e){var r;let{metadata:n,resourceType:s,resourceId:t,resourceTypeDisplayName:a}=e,{currentPermission:l,handleUpdateGeneralAccess:o,shareResourceMutation:c,unshareResourceMutation:d}=D({metadata:n,resourceType:s,resourceId:t}),u=(null===(r=h.workspaceData.value)||void 0===r?void 0:r.name)||"your workspace";return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)(w.x,{weight:"semi-bold",children:"Default Access"}),(0,i.jsxs)(w.x,{size:"xs",children:["restricted"===l.key?"Only admins":"Anyone"," in"," ",u," can"," ","viewer"===l.key?"view":"edit"," and use your"," ",a,"."]})]}),(0,i.jsxs)(b.Select,{value:l.key,onValueChange:e=>{let r=P.find(r=>r.key===e);r&&o(r)},children:[(0,i.jsx)(b.SelectTrigger,{className:"rounded-lg w-32",disabled:c.isLoading||d.isLoading,children:(0,i.jsx)(b.SelectValue,{})}),(0,i.jsx)(b.SelectContent,{className:"w-32",children:P.map(e=>(0,i.jsx)(b.SelectItem,{value:e.key,children:e.name},e.key))})]})]})}let z=e=>{let{metadata:r,resourceName:n}=e,[s,t]=(0,c.useState)(null),[a,l]=(0,d.OT)(!1),o={all:r.share_options,users:r.share_options.filter(e=>"user"===e.type),groups:r.share_options.filter(e=>"group"===e.type),service_accounts:r.share_options.filter(e=>"key"===e.type)};return 0===o.all.length?null:(0,i.jsxs)(i.Fragment,{children:[s&&(0,i.jsx)(A,{open:a,closeModal:l,name:n,resourceId:r.resource_id,resourceType:r.resource_type,group:s}),(0,i.jsx)(w.x,{weight:"semi-bold",children:"Share with Others"}),(0,i.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,i.jsxs)(b.Select,{value:null==s?void 0:s.id,onValueChange:e=>{let r=o.all.find(r=>r.id===e);r&&t(r)},children:[(0,i.jsx)(b.SelectTrigger,{className:"rounded-lg max-w-md w-[300px]",children:(0,i.jsx)(b.SelectValue,{placeholder:"Select to share"})}),(0,i.jsxs)(b.SelectContent,{children:[o.groups.length>0&&(0,i.jsxs)(b.SelectGroup,{children:[(0,i.jsx)(b.SelectLabel,{children:"Groups"}),o.groups.map(e=>(0,i.jsx)(b.SelectItem,{value:e.id,children:e.name},e.id))]}),o.service_accounts.length>0&&(0,i.jsxs)(b.SelectGroup,{children:[(0,i.jsx)(b.SelectLabel,{children:"Service Accounts"}),o.service_accounts.map(e=>(0,i.jsx)(b.SelectItem,{value:e.id,children:e.name},e.id))]}),o.users.length>0&&(0,i.jsxs)(b.SelectGroup,{children:[(0,i.jsx)(b.SelectLabel,{children:"Users"}),o.users.map(e=>(0,i.jsx)(b.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,i.jsx)(f.Button,{variant:"primary",onClick:l,disabled:!s,children:"Share"})]})]})},F=e=>{let{metadata:r,groups:n,workspaceServiceAccounts:i,resourceId:s}=e,[a,l]=(0,c.useState)(0),o=r.creator_user_id,d=(0,t.useQueryClient)();return{page:a,setPage:l,sharedWith:(0,c.useMemo)(()=>Object.entries(r.role_to_group_ids||{}).flatMap(e=>{let[r,s]=e;return s.filter(e=>e!==C).map(e=>{let s=null==n?void 0:n[e],t=null==i?void 0:i["service-accounts"].find(r=>r.service_account_user_id===e),a=void 0!==t,l=!a&&(null==s?void 0:s.members.length)===1&&s.members[0]===e;return{role:r,group_id:e,name:a?t.name:(null==s?void 0:s.name)||"Unknown",type:a?"key":l?"user":"group"}})}),[r,n,i]),resourceOwner:o,shareResourceMutation:(0,u.T3r)({onError:e=>_.toast.errorHttp(e,"Failed to update sharing settings"),onSuccess(){_.toast.success("Successfully updated role"),d.invalidateQueries(["v1","workspace","resources",s])}}),unshareResourceMutation:(0,u.$ir)({onError:e=>_.toast.errorHttp(e,"Failed to update sharing settings"),onSuccess(){_.toast.success("Successfully revoked access"),d.invalidateQueries(["v1","workspace","resources",s])}})}};function O(e){var r;let{metadata:n,groups:t,workspaceServiceAccounts:c,resourceId:d,resourceType:u}=e,h=null===(r=N.EA.value)||void 0===r?void 0:r.email,{page:f,setPage:v,sharedWith:y,resourceOwner:_,shareResourceMutation:k,unshareResourceMutation:C}=F({metadata:n,groups:t,resourceId:d,workspaceServiceAccounts:c});return 0===y.length?(0,i.jsx)(m.Z,{severity:"info",withIcon:!1,children:"Not shared with any users or groups yet."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.aV,{children:(0,i.jsx)(j.UB,{classes:{heading:"px-0",divider:"hidden"},label:(0,i.jsx)(w.x,{weight:"semi-bold",children:"Shared with Users and Groups"}),children:y.slice(5*f,(f+1)*5).sort((e,r)=>{if(e.group_id==_)return -1;if(r.group_id==_)return 1;let n=e.role.localeCompare(r.role);return 0!==n?n:e.name.localeCompare(r.name)}).map(e=>{let r=e.group_id===_||e.name===h;return(0,i.jsxs)(j.HC,{className:"px-0",children:[(0,i.jsxs)(j.Ek,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)(j.L9,{children:"user"===e.type?(0,i.jsx)(a.Z,{className:"h-6 w-6"}):"group"===e.type?(0,i.jsx)(l.Z,{className:"h-6 w-6"}):(0,i.jsx)(o.Z,{className:"h-6 w-6"})}),(0,i.jsx)(p.default,{children:e.name})]}),(0,i.jsxs)(b.Select,{value:e.group_id===_?E.key:e.role,onValueChange:r=>{k.mutate({pathParams:{resourceId:d},body:{resource_type:u,group_id:e.group_id,role:r}})},disabled:r,children:[(0,i.jsx)(b.SelectTrigger,{className:"rounded-lg capitalize w-32",disabled:k.isLoading,children:(0,i.jsx)(b.SelectValue,{})}),(0,i.jsx)(b.SelectContent,{className:"w-32",children:e.group_id===_?(0,i.jsx)(b.SelectItem,{value:E.key,children:E.name},E.key):L.map(e=>(0,i.jsx)(b.SelectItem,{value:e.key,children:e.name},e.key))})]})]}),(0,i.jsx)(j.cT,{children:(0,i.jsx)(g.h,{disabled:r,title:"Revoke","aria-label":"Revoke",size:"sm",onClick:async()=>{(await S.y.request({title:"Revoke Access",description:"Are you sure you want to remove access for the member or group: ".concat(e.name,"?"),confirmText:"Revoke",cancelText:"Cancel"})).confirmed&&C.mutate({pathParams:{resourceId:d},body:{resource_type:u,group_id:e.group_id}})},children:(0,i.jsx)(s.Z,{className:"h-4 w-4"})})})]},e.group_id)})})}),y.length>5&&(0,i.jsx)("div",{className:"mt-4 flex justify-center",children:(0,i.jsx)(x.T,{page:f,itemsPerPage:5,onChange:v,itemCount:y.length})})]})}r.ZP=e=>{let{resourceId:r,resourceName:n,resourceType:s,resourceTypeDisplayName:t=s,className:a}=e,l=(0,u.NFJ)({},{onError:e=>_.toast.errorHttp(e,"Failed to load workspace groups")}),o=(0,u.J7e)({},{onError:e=>_.toast.errorHttp(e,"Failed to load workspace service accounts")}),c=(0,u.Vzh)({pathParams:{resourceId:r},queryParams:{resource_type:s}},{onError:e=>_.toast.errorHttp(e,"Failed to load resource metadata")});return(0,i.jsxs)("div",{className:(0,k.cn)("stack gap-3 mt-5",a),children:[(0,i.jsxs)(w.x,{size:"sm",children:["By default, your ",t," is accessible to administrators within your workspace. You can modify sharing settings for more control."]}),c.data&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{metadata:c.data,resourceType:s,resourceId:r,resourceTypeDisplayName:t}),(0,i.jsx)(z,{metadata:c.data,resourceName:n}),(0,i.jsx)(O,{metadata:c.data,groups:l.data,workspaceServiceAccounts:o.data,resourceId:r,resourceType:s})]})]})}},732:function(e,r,n){n.d(r,{h:function(){return m},k:function(){return x}});var i=n(23431),s=n(9506),t=n(30487),a=n(1851),l=n(60358),o=n(84106),c=n(99348);let d=(0,n(21113).Z)("file:///app/src/utils/useOnboarding.ts"),u="xi:is_onboarding_completed",h=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e,m=async e=>{localStorage.setItem(u,"true");try{await (0,t.JNS)({body:{first_name:h(null==e?void 0:e.firstName),role:e.role,subrole:e.subrole,timezone:null==e?void 0:e.timezone,source:null==e?void 0:e.source,usecases:null==e?void 0:e.usecases,theme:null==e?void 0:e.theme,birthday_unix:Math.floor(new Date(null==e?void 0:e.birthdate).getTime()/1e3)}})}catch(e){o.toast.error("Could not save your preferences, please try again."),d.error(e)}},x=()=>{let e=(0,i.useRouter)(),r=(0,i.usePathname)(),n="local"!==(0,c.d)().envType;(0,s.useEffect)(()=>{var i;!a.isLoggedIn.value||!a.userData.value||(null==r?void 0:r.includes(l.VP.onboarding))||!n||(null===(i=a.userData.value)||void 0===i?void 0:i.is_onboarding_completed)||localStorage.getItem(u)||((0,o.toast)("You must complete onboarding to continue using ElevenLabs"),e.push(l.VP.onboarding))},[r,a.isLoggedIn.value,n,a.userData.value])}}}]);